{% if config.show_charts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log("Chart initialization script running");

        // Create summary pie chart
        const summaryCtx = document.getElementById('summary-chart');
        if (summaryCtx) {
            console.log("Found summary chart canvas");

            const summaryData = {
                labels: ['Passed', 'Failed', 'Skipped'],
                datasets: [{
                    data: [
                        {{ summary.attempted - summary.failed }},
                        {{ summary.failed }},
                        {{ summary.skipped }}
                    ],
                    backgroundColor: [
                        'rgba(39, 174, 96, 0.7)',  // Passed - green
                        'rgba(192, 57, 43, 0.7)',  // Failed - red
                        'rgba(243, 156, 18, 0.7)'  // Skipped - yellow
                    ],
                    borderColor: [
                        'rgba(39, 174, 96, 1)',
                        'rgba(192, 57, 43, 1)',
                        'rgba(243, 156, 18, 1)'
                    ],
                    borderWidth: 1
                }]
            };

            const summaryChart = new Chart(summaryCtx, {
                type: 'pie',
                data: summaryData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        title: {
                            display: true,
                            text: 'Test Results Summary'
                        }
                    }
                }
            });
            console.log("Summary chart created");
        } else {
            console.log("Could not find summary-chart canvas element");
        }

        // Create suites bar chart
        const suitesCtx = document.getElementById('suites-chart');
        if (suitesCtx && {{ suites|length }} > 1) {
            console.log("Found suites chart canvas");

            const suiteLabels = [{% for suite_name in suites.keys() %}'{{ suite_name }}',{% endfor %}];
            const passedData = [{% for suite in suites.values() %}{{ suite.attempted - suite.failed }},{% endfor %}];
            const failedData = [{% for suite in suites.values() %}{{ suite.failed }},{% endfor %}];
            const skippedData = [{% for suite in suites.values() %}{{ suite.skipped }},{% endfor %}];

            console.log("Suite data prepared:", {suiteLabels, passedData, failedData, skippedData});

            const suitesData = {
                labels: suiteLabels,
                datasets: [
                    {
                        label: 'Passed',
                        data: passedData,
                        backgroundColor: 'rgba(39, 174, 96, 0.7)'
                    },
                    {
                        label: 'Failed',
                        data: failedData,
                        backgroundColor: 'rgba(192, 57, 43, 0.7)'
                    },
                    {
                        label: 'Skipped',
                        data: skippedData,
                        backgroundColor: 'rgba(243, 156, 18, 0.7)'
                    }
                ]
            };

            const suitesChart = new Chart(suitesCtx, {
                type: 'bar',
                data: suitesData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            stacked: true,
                        },
                        y: {
                            stacked: true
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Test Results by Suite'
                        }
                    }
                }
            });
            console.log("Suites chart created");
        } else if ({{ suites|length }} <= 1) {
            console.log("Not enough suites to display chart");
        } else {
            console.log("Could not find suites-chart canvas element");
        }
    });
</script>
{% endif %}